#!/bin/sh

usage() {
  printf "\
Commands:
  barista local RECIPE [RECIPE...]  # Run Barista locally
  barista ssh RECIPE [RECIPE...]    # Run Barista via ssh
  barista build RECIPE [RECIPE...]  # Build single script file
  barista help                      # Disiplay help
"
}

BARISTA_RUN_MODE=$1
source $(dirname $0)'/../src/barista.sh'

shift

case $BARISTA_RUN_MODE in
build)
  ;;
local)
  BARISTA_LOG_LEVEL=${BARISTA_LOG_LEVEL-info}
  ;;
ssh)
  echo 'Not implemented' >&2
  exit 1
  ;;
help)
  usage
  exit 0
  ;;
*)
  usage
  exit 1
esac

info "Starting barista..."
for recipe in $@; do
  info "Recipe: $recipe"
  source $recipe
done
